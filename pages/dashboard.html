<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Green Shadow</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <style>
        /*main css*/
        #main {
            margin-top: 60px;
            padding: 30px 10px;
            transition: all 0.3s;
            background: #f1f1f1 !important;
            color: #444444 !important;
        }

        @media (max-width: 1199px) {
            #main {
                padding: 20px;
            }
        }
        /*Dashboard css*/
        .dash-overview .card {
            padding: 15px;
            border: none;
            border-bottom: 3px solid #00bcd9;
        }

        .dash-overview .card h1 {
            margin-bottom: 4px;
            font-size: 34px;
        }

        .dash-overview .card p {
            margin: 0px;
            font-size: 15px;
            color: gray;
        }
        /*bar chart css*/
        .bar { opacity: 0.5; }

        .label, .amount{
            text-anchor: middle;
            text-transform: uppercase;
            font-family:  Impact, Charcoal, sans-serif;
            font-size: 4em;
        }
        #chart {
            background: #f1f1f1;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-custom navbar-mainbg">
    <a class="navbar-brand navbar-logo" href="#">Navbar</a>
    <button class="navbar-toggler" type="button" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars text-white"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
            <div class="hori-selector">
                <div class="left"></div>
                <div class="right"></div>
            </div>
            <li class="nav-item ">
                <a class="nav-link" href="dashboard.html"><i class="fas fa-tachometer-alt"></i>Dashboard</a>
            </li>
            <li class="nav-item ">
                <a class="nav-link" href="crop.html"><i class="fa fa-crop" aria-hidden="true"></i> Crop Manage</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="field.html"><i class="far fa-clone"></i>Field Manage</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="staff.html"><i class="fa fa-users" aria-hidden="true"></i>Staff Manage</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="vehicle.html"><i class="fa fa-car" aria-hidden="true"></i>Vehicle Manage</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="log.html"><i class="far fa-calendar-alt"></i>Log Manage</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="equipment.html"><i class="far fa-copy"></i>Equipment Manage</a>
            </li>
        </ul>
    </div>
</nav>
<!-- main -->
<main id="main" class="container shadow-lg rounded-4 ">
    <div class="container-fluid table-index">
        <div class="row g-3  mb-3">
            <div class="col-md-4">
                <h5>Dashboard</h5>
            </div>
        </div>

        <section class="dash-overview ">
            <div class="row g-4 justify-content-between">
                <div class="col-lg-3 col-md-3">
                    <div class="card">
                        <h1>10</h1>
                        <p>Active Vehicles</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 ">
                    <div class="card">
                        <h1>20</h1>
                        <p>Active Fields</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 ">
                    <div class="card">
                        <h1>300</h1>
                        <p>Active Equipment</p>
                    </div>
                </div>
                <div class="col-lg-3 col-md-3 ">
                    <!--<div class="card">
                        <h1>25</h1>
                        <p>Alipay</p>
                    </div>-->
                    <div class="card">
                        <h1>25°C  <i class="fas fa-sun"></i></h1>
                        <p>Sunny</p>
                    </div>

                </div>
            </div>
        </section>
    </div>
</main>
<section id="chart" class="container mt-lg-5"></section>
<footer>
    <p>© 2023 GreenShadow. All rights reserved.</p>
</footer>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="//d3js.org/d3.v4.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="../js/main.js"></script>
<script>
    // Load the data
    // Set the dimensions and margins of the graph
    var margin = { top: 20, right: 20, bottom: 30, left: 40 },
        viewboxWidth = 960,
        viewboxHeight = 500,
        width = viewboxWidth - margin.left - margin.right,
        height = viewboxHeight - margin.top - margin.bottom;

    // Set the ranges
    var x = d3.scaleBand()
        .range([0, width])
        .padding(0.1);
    var y = d3.scaleLinear()
        .range([height, 100]);

    // Append the SVG object using jQuery
    var $chart = $("#chart");
    $chart.empty(); // Clear existing content
    var svg = d3.select($chart[0]).append("svg")
        .attr("preserveAspectRatio", "none")
        .attr("viewBox", "0 0 " + viewboxWidth + " " + viewboxHeight)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    var data = [
        { label: 'crop', value: 0, color: '#689f38' },
        { label: 'field', value: 0, color: '#f50057' },
        { label: 'staff', value: 0, color: '#9c27b0' },
        { label: 'vehicle', value: 0, color: '#ffc107' },
        { label: 'log', value: 0, color: '#009688' },
        { label: 'Equipment', value: 0, color: '#ffc107' },
    ];

    var newData = function (data) {
        var customValues = [10, 12, 34, 56, 109,40]; // Define the custom values
        return data.map(function (d, i) {
            d.oldValue = d.value;
            d.value = customValues[i % customValues.length]; // Assign values cyclically if data length exceeds customValues length
            return d;
        });
    };
    var init = function (data) {
        x.domain(data.map(function (d) { return d.label; }));
        y.domain([0, d3.max(data, function (d) { return d.value; })]);

        var bars = svg.selectAll(".bar")
            .data(data);

        bars.enter().append("rect")
            .attr("class", "bar")
            .attr("fill", function (d) { return d.color; })
            .attr("x", function (d) { return x(d.label); })
            .attr("width", x.bandwidth())
            .attr("y", height)
            .attr("height", "0")
            .exit()
            .remove();

        var labels = svg.selectAll(".label")
            .data(data)
            .enter()
            .append("text")
            .attr("class", "label")
            .attr("fill", function (d) { return d.color; })
            .text(function (d) { return d.label; })
            .attr("x", function (d) { return x(d.label) + (x.bandwidth() / 2); })
            .attr("y", height - 10)
            .attr('textLength', x.bandwidth() - 10)
            .attr('lengthAdjust', 'spacingAndGlyphs')
            .exit()
            .remove();

        var amounts = svg.selectAll(".amount")
            .data(data)
            .enter()
            .append("text")
            .text(0)
            .attr("class", "amount")
            .attr("fill", function (d) { return d.color; })
            .attr("x", function (d) { return x(d.label) + (x.bandwidth() / 2); })
            .attr('y', height - 66)
            .exit()
            .remove();

        drawChart(data);
    };

    var drawChart = function (data) {
        x.domain(data.map(function (d) { return d.label; }));
        y.domain([0, d3.max(data, function (d) { return d.value; })]);

        var bars = svg.selectAll(".bar")
            .data(data);

        bars.enter().append("rect")
            .attr("class", "bar")
            .attr("fill", function (d) { return d.color; });

        bars.exit()
            .transition()
            .duration(300)
            .ease(d3.easeExp)
            .attr("height", 0)
            .remove();

        bars.transition()
            .duration(1000)
            .ease(d3.easeQuad)
            .attr("x", function (d) { return x(d.label); })
            .attr("width", x.bandwidth())
            .attr("y", function (d) { return y(d.value); })
            .attr("height", function (d) { return height - y(d.value); });

        var labels = svg.selectAll(".label")
            .data(data)
            .enter()
            .append("text")
            .attr("class", "label")
            .attr("fill", function (d) { return d.color; })
            .text(function (d) { return d.label; })
            .attr("x", function (d) { return x(d.label) + (x.bandwidth() / 2); })
            .attr("y", height - 10)
            .attr('textLength', x.bandwidth() - 10)
            .attr('lengthAdjust', 'spacingAndGlyphs')
            .exit()
            .remove();

        var amounts = svg.selectAll(".amount")
            .data(data);

        amounts.enter()
            .append("text")
            .attr("class", "amount");

        amounts.exit()
            .transition()
            .duration(1000)
            .ease(d3.easeExp)
            .attr("y", 0)
            .remove();

        var format = d3.format(",d");
        amounts.transition()
            .duration(1000)
            .ease(d3.easeQuad)
            .tween("text", function (d) {
                var that = d3.select(this),
                    i = d3.interpolateNumber(d.oldValue, d.value);
                return function (t) { that.text(format(i(t))); };
            })
            .attr("fill", function (d) { return d.color; })
            .attr("x", function (d) { return x(d.label) + (x.bandwidth() / 2); })
            .attr("y", function (d) { return y(d.value) - 5; });
    };
    init(newData(data));
    drawChart(newData(data));

</script>
</body>
</html>
